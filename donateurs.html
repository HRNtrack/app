<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HRNtrack | Donateurs</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary: #4F46E5;
            --primary-dark: #4338ca;
            --bg-body: #F3F4F6;
            --text-main: #1F2937;
            --text-sub: #9CA3AF;
            --gold: #F59E0B;
            --dark-bg: #111827;
            --card-bg: #ffffff;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        body { 
            background-color: var(--bg-body); 
            color: var(--text-main); 
            font-family: 'Poppins', sans-serif; 
            margin: 0; 
            display: flex; flex-direction: column; min-height: 100vh;
        }

        /* --- HEADER & NAV --- */
        .top-nav {
            background: var(--dark-bg); color: white; padding: 15px 20px;
            display: flex; justify-content: space-between; align-items: center;
            position: sticky; top: 0; z-index: 1000;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        }

        .site-logo { height: 80px; }

        .nav-center {
            position: absolute; left: 50%; transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.1); padding: 4px;
            border-radius: 12px; display: flex; gap: 4px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            z-index: 2000;
        }

        .nav-link {
            text-decoration: none; color: #9CA3AF; padding: 6px 16px;
            border-radius: 8px; font-size: 12px; font-weight: 600;
            transition: all 0.3s ease; display: flex; align-items: center; gap: 6px;
        }
        .nav-link:hover { color: white; background: rgba(255, 255, 255, 0.05); }
        .nav-link.active { background: var(--primary); color: white; box-shadow: 0 2px 10px rgba(79, 70, 229, 0.4); }

        .nav-right { display: flex; align-items: center; gap: 15px; }

        .lang-toggle {
            display: flex; background: rgba(255,255,255,0.1); border-radius: 20px;
            padding: 2px; cursor: pointer; border: 1px solid rgba(255,255,255,0.2);
        }
        .lang-option {
            padding: 6px 12px; border-radius: 16px; font-size: 11px; font-weight: 700;
            color: #9CA3AF; transition: all 0.3s ease;
        }
        .lang-option.active { background: var(--primary); color: white; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }

        .btn-auth-trigger {
            background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.2); color: white; 
            padding: 8px 16px; border-radius: 10px; cursor: pointer; font-size: 13px; font-weight: 600; 
            transition: 0.2s; display: flex; align-items: center; gap: 8px;
        }
        .btn-auth-trigger.logged-in { background: rgba(16, 185, 129, 0.2); border-color: rgba(16, 185, 129, 0.4); color: #6EE7B7; }

        @media (max-width: 600px) {
            .site-logo { display: none; } 
            .nav-center { 
                position: fixed; bottom: 20px; top: auto; 
                transform: translateX(-50%); background: rgba(17, 24, 39, 0.95);
                box-shadow: 0 10px 30px rgba(0,0,0,0.5);
                z-index: 1000;
            }
        }

        /* --- CONTAINER & DONATIONS --- */
        .container { max-width: 800px; margin: 40px auto; padding: 0 20px; width: 100%; box-sizing: border-box; flex: 1; }
        .goal-card { background: white; padding: 40px; border-radius: 20px; box-shadow: var(--shadow); text-align: center; margin-bottom: 40px; position: relative; overflow: hidden; }
        .goal-title { font-size: 14px; color: var(--text-sub); text-transform: uppercase; letter-spacing: 2px; font-weight: 700; margin-bottom: 10px; }
        .goal-amount { font-size: 48px; font-weight: 800; color: var(--primary); margin: 0; }
        .progress-container { height: 24px; background: #E5E7EB; border-radius: 12px; overflow: hidden; margin: 20px auto; max-width: 600px; position: relative; }
        .progress-bar { height: 100%; background: linear-gradient(90deg, #F59E0B, #FBBF24); width: 0%; transition: width 1.5s cubic-bezier(0.4, 0, 0.2, 1); border-radius: 12px; box-shadow: 0 0 15px rgba(245, 158, 11, 0.5); }
        .progress-text { position: absolute; width: 100%; text-align: center; top: 0; line-height: 24px; font-size: 11px; font-weight: 800; color: #374151; z-index: 2; mix-blend-mode: overlay; }

        .donors-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; }
        .donor-card { background: white; padding: 15px; border-radius: 12px; box-shadow: var(--shadow); display: flex; align-items: center; justify-content: space-between; border-left: 4px solid var(--primary); }
        .donor-name { font-weight: 600; font-size: 14px; }
        .donor-amount { font-weight: 700; color: var(--primary); font-size: 16px; background: #EEF2FF; padding: 4px 8px; border-radius: 6px; }

        #admin-panel { display: none; background: #1F2937; padding: 20px; border-radius: 15px; margin-bottom: 30px; color: white; }
        .admin-row { display: flex; gap: 10px; margin-top: 10px; }
        .admin-input { flex: 1; padding: 10px; border-radius: 6px; border: none; }
        .btn-add { background: var(--primary); color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: 600; }

        /* MODALS */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 3000; align-items: center; justify-content: center; backdrop-filter: blur(5px); }
        .modal-content { background: white; width: 90%; max-width: 420px; padding: 25px; border-radius: 20px; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25); max-height: 90vh; overflow-y: auto; position: relative; }
        
        .form-label { font-size: 11px; color: var(--text-sub); font-weight: 700; text-transform: uppercase; margin-bottom: 6px; display: block; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px; }
        input, select, textarea { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #E5E7EB; font-family: inherit; font-size: 14px; box-sizing: border-box; }
        .btn-save { width: 100%; background: #111827; color: white; border: none; padding: 14px; border-radius: 10px; font-weight: 600; cursor: pointer; margin-top: 10px; transition: 0.2s; }
        .btn-save:hover { background: var(--primary); }
        .btn-cancel { width: 100%; background: transparent; border: none; color: var(--text-sub); padding: 10px; cursor: pointer; margin-top: 5px; font-size: 12px; }

        .auth-title { text-align: center; font-size: 24px; font-weight: 800; margin-bottom: 20px; color: #111827; }
        .auth-separator { display: flex; align-items: center; margin: 20px 0; color: #9CA3AF; font-size: 12px; }
        .auth-separator::before, .auth-separator::after { content: ""; flex: 1; height: 1px; background: #E5E7EB; margin: 0 10px; }

        /* FOOTER */
        .site-footer { background-color: var(--dark-bg); color: #9CA3AF; padding: 60px 20px 20px; margin-top: auto; border-top: 1px solid #374151; font-size: 13px; }
        .footer-content { max-width: 1100px; margin: 0 auto; display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 30px; }
        .footer-col h4 { color: white; margin: 0 0 15px 0; font-size: 14px; text-transform: uppercase; letter-spacing: 1px; }
        .footer-links { list-style: none; padding: 0; }
        .footer-links li { margin-bottom: 8px; }
        .footer-links a { color: #9CA3AF; text-decoration: none; transition: color 0.2s; }
        .footer-links a:hover { color: #818cf8; }
        .footer-bottom { text-align: center; margin-top: 40px; padding-top: 20px; border-top: 1px solid #1F2937; font-size: 11px; color: #6B7280; }
    </style>
</head>
<body>

    <nav class="top-nav">
        <div style="display:flex; align-items:center; gap:10px;">
             <img src="https://i.postimg.cc/yNdVZYsy/logo1-blanc.png" class="site-logo" alt="Logo">
        </div>
        <div class="nav-center">
            <a href="index.html" class="nav-link"><span>üè†</span> <span data-t="navHome">Accueil</span></a>
            <a href="dashboard.html" class="nav-link"><span>üìã</span> <span data-t="navCollection">Collection</span></a>
            <a href="statistiques.html" class="nav-link"><span>üìä</span> <span data-t="navStats">Stats</span></a>
        </div>
        <div class="nav-right">
            <div class="lang-toggle" onclick="window.toggleLanguage()">
                <div class="lang-option active" id="lang-fr">FR</div>
                <div class="lang-option" id="lang-en">EN</div>
            </div>
            <button id="auth-trigger" class="btn-auth-trigger" onclick="window.toggleAuthModal()">
                <span>üë§</span> <span id="auth-status-text" data-t="authLogin">Connexion</span>
            </button>
        </div>
    </nav>

    <div class="container">
        <div id="admin-panel">
            <h3 style="margin:0 0 10px 0;">üëë Ajouter un donateur</h3>
            <div class="admin-row">
                <input type="text" id="new-name" class="admin-input" placeholder="Nom">
                <input type="number" id="new-amount" class="admin-input" placeholder="‚Ç¨">
                <button class="btn-add" onclick="window.addDonation()">Ajouter</button>
            </div>
        </div>

        <div class="goal-card">
            <div class="goal-title" data-t="lblGoalTitle">Objectif du moment</div>
            <h1 class="goal-amount" id="total-raised">0‚Ç¨</h1>
            <div style="color:var(--text-sub);"><span data-t="lblGoalTarget">sur</span> <span id="goal-target-text">0‚Ç¨</span></div>
            <div class="progress-container">
                <div id="progress-bar" class="progress-bar"></div>
                <div id="progress-percent" class="progress-text">0%</div>
            </div>
            <p style="font-size:12px; color:#9CA3AF;"><span data-t="lblGoalDesc">Merci de votre soutien ! ‚ù§Ô∏è</span></p>
        </div>

        <h2 style="font-size:18px; border-bottom:2px solid #E5E7EB; padding-bottom:10px; margin-bottom:20px;">
            ‚ú® <span data-t="lblWall">Mur des Donateurs</span>
        </h2>
        <div id="donors-list" class="donors-grid"></div>
    </div>

    <div id="auth-modal" class="modal-overlay">
        <div class="modal-content" style="text-align:center;">
            <div class="auth-title" data-t="authLogin">Connexion</div>
            <input type="email" id="auth-email" placeholder="Email" style="margin-bottom:10px;">
            <input type="password" id="auth-pass" placeholder="Password" style="margin-bottom:20px;">
            <button class="btn-add" style="width:100%" onclick="window.handleLogin()" data-t="btnLogin">Se connecter</button>
            <button class="btn-cancel" onclick="window.toggleAuthModal()" data-t="btnCancel">Annuler</button>
        </div>
    </div>

    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-col">
                <img src="https://i.postimg.cc/yNdVZYsy/logo1-blanc.png" alt="HRNtrack" style="height: 100px; margin-bottom: 15px; opacity: 0.8;">
                <p data-t="footerDesc">L'outil ultime pour suivre votre collection Hirono.</p>
            </div>
            <div class="footer-col">
                <h4 data-t="footerNav">Navigation</h4>
                <ul class="footer-links">
                    <li><a href="index.html" data-t="navHome">Accueil</a></li>
                    <li><a href="dashboard.html" data-t="navCollection">Collection</a></li>
                    <li><a href="statistiques.html" data-t="navStats">Statistiques</a></li>
                    <li><a href="donateurs.html" data-t="navDonors">Donateurs</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h4 data-t="footerAbout">√Ä propos</h4>
                <p data-t="footerDisclaimer">Ce site est un projet de fan (Fanmade).<br>Nous ne sommes pas affili√©s √† <strong>POP MART</strong>.</p>
            </div>
        </div>
        <div class="footer-bottom">&copy; 2025 HRNtrack. Fait avec passion.</div>
    </footer>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, getDocs, query, orderBy, Timestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = { apiKey: "AIzaSyB1vHxCeB4IfNWpTibp64WgNP30KlXMaAc", authDomain: "hrntrack-1cfe3.firebaseapp.com", projectId: "hrntrack-1cfe3", storageBucket: "hrntrack-1cfe3.firebasestorage.app", messagingSenderId: "1059019333826", appId: "1:1059019333826:web:fa184b796b847cc0f2db5b" };
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        const GOAL_AMOUNT = 100;
        const ADMIN_EMAIL = "hironotrack@gmail.com"; 

        const translations = {
            fr: { navHome: "Accueil", navCollection: "Collection", navStats: "Stats", navDonors: "Donateurs", authLogin: "Connexion", authAccount: "Compte", btnLogin: "Se connecter", btnCancel: "Annuler", footerDesc: "L'outil ultime pour suivre votre collection Hirono.", footerNav: "Navigation", footerAbout: "√Ä propos", footerDisclaimer: "Ce site est un projet de fan (Fanmade). Nous ne sommes pas affili√©s √† POP MART.", lblGoalTitle: "Objectif du moment", lblGoalTarget: "sur", lblGoalDesc: "Merci de votre soutien ! ‚ù§Ô∏è", lblWall: "Mur des Donateurs" },
            en: { navHome: "Home", navCollection: "Collection", navStats: "Stats", navDonors: "Donors", authLogin: "Login", authAccount: "Account", btnLogin: "Log In", btnCancel: "Cancel", footerDesc: "The ultimate tool to track your Hirono collection.", footerNav: "Navigation", footerAbout: "About", footerDisclaimer: "This is a fanmade project. We are not affiliated with POP MART.", lblGoalTitle: "Current Goal", lblGoalTarget: "of", lblGoalDesc: "Thanks for your support! ‚ù§Ô∏è", lblWall: "Wall of Donors" }
        };

        let currentLang = localStorage.getItem('HRN_LANG') || 'fr';
        window.toggleLanguage = () => { currentLang = (currentLang === 'fr') ? 'en' : 'fr'; localStorage.setItem('HRN_LANG', currentLang); updateUIText(); loadDonations(); };

        function updateUIText() {
            const t = translations[currentLang];
            document.querySelectorAll('[data-t]').forEach(el => { const key = el.getAttribute('data-t'); if(t[key]) el.innerText = t[key]; });
            document.getElementById('lang-fr').className = currentLang === 'fr' ? 'lang-option active' : 'lang-option';
            document.getElementById('lang-en').className = currentLang === 'en' ? 'lang-option active' : 'lang-option';
            const user = auth.currentUser;
            document.getElementById('auth-status-text').innerText = user ? t.authAccount : t.authLogin;
        }

        window.toggleAuthModal = () => { const el = document.getElementById('auth-modal'); el.style.display = (el.style.display === 'flex') ? 'none' : 'flex'; };
        window.handleLogin = async () => { try { await signInWithEmailAndPassword(auth, document.getElementById('auth-email').value, document.getElementById('auth-pass').value); window.toggleAuthModal(); } catch(e) { alert(e.message); } };
        window.handleLogout = async () => { if(confirm("D√©connexion ?")) { await signOut(auth); location.reload(); } };

        async function loadDonations() {
            const t = translations[currentLang];
            const q = query(collection(db, "donations"), orderBy("date", "desc"));
            const snapshot = await getDocs(q);
            let total = 0, html = "";
            snapshot.forEach(doc => {
                const data = doc.data(); total += parseFloat(data.amount);
                html += `<div class="donor-card"><span class="donor-name">${data.name}</span><span class="donor-amount">${data.amount}‚Ç¨</span></div>`;
            });
            document.getElementById('donors-list').innerHTML = html || `<p style='color:gray'>${t.lblWall}...</p>`;
            document.getElementById('total-raised').innerText = total.toFixed(2) + "‚Ç¨";
            document.getElementById('goal-target-text').innerText = GOAL_AMOUNT + "‚Ç¨";
            let percent = Math.min((total / GOAL_AMOUNT) * 100, 100);
            document.getElementById('progress-bar').style.width = percent + "%";
            document.getElementById('progress-percent').innerText = Math.round(percent) + "%";
        }

        onAuthStateChanged(auth, (user) => {
            updateUIText();
            const btn = document.getElementById('auth-trigger');
            if (user) {
                btn.classList.add('logged-in'); btn.onclick = () => window.handleLogout();
                if(user.email === ADMIN_EMAIL) document.getElementById('admin-panel').style.display = 'block';
            } else {
                btn.classList.remove('logged-in'); btn.onclick = () => window.toggleAuthModal();
            }
        });

        window.addDonation = async () => {
            const n = document.getElementById('new-name').value, a = document.getElementById('new-amount').value;
            if(!n || !a) return;
            await addDoc(collection(db, "donations"), { name: n, amount: parseFloat(a), date: Timestamp.now() });
            location.reload();
        };

        loadDonations();
    </script>
</body>
</html>